### SpringCloudNetflix

##### 服务的注册与发现：Eureka

* Eureka Client：负责将这个服务的注册信息注册到Eureka Server中
* Eureka Server：注册中心，里面有一个注册表，保存了各个服务所在的机器和端口

##### 服务调用与负载均衡：Ribbon&Feign

* **Feign**：与其他服务建立连接（**服务调用**）
  1. 对某个接口定义@FeignClient注解，Feign会针对这个接口创建一个动态代理
  2. 调用这个接口，本质就是调用Feign创建的动态代理
  3. Feign的动态代理会根据你的接口的@RequestMapping等注解，来动态构造出要请求的服务的地址
  4. 最后针对这个地址，发起请求、解析响应
* **Ribbo**：均匀的把请求分发到各个机器上（**负载均衡**）
  1. Ribbo会从Eureka Client里获取到对应的服务注册表，也就知道了所有的服务器都部署在了那些机器上，在监听哪些端口号
  2. Ribbo使用默认的Round Robbin(轮询)算法，从中选择一台机器
  3. Feign针对这台机器，构造并发起请求

##### 服务熔断与服务降级：Hystrix

多服务互相调用， 要是不做任何保护的话，某一个服务挂了，就会引起连锁反应，导致别的服务也挂。

* Hystrix是隔离、熔断以及降级的一个框架
  * 隔离：每个服务单独一个线程池，互不影响
  * 熔断：若某一个服务挂了，该时间段的请求直接返回，不发送网络请求
  * 降级：没次调用挂掉的服务，都记录一条消息，后续手工添加

##### 服务网关与动态路由：Zuul&GateWay

* **Zuul**：微服务网关
  * 所有请求都往网关走，网关会根据请求中的一些特征，将请求转发给后端的各个服务
  * 可以做统一的降级、限流、认证授权、安全，等等

##### 分布式配置中心：Config

* Spring Cloud Config为分布式系统中的外部配置提供服务器和客户端支持。使用Config Server，可以在所有环境中管理应用程序的外部属性。

##### 总结

* Eureka：各个服务启动时，Eureka Client都会将服务注册到Eureka Server，并且Eureka Client还可以反过来从Eureka Server 拉取注册表，从而知道服务在哪里
* Ribbo：服务间发起请求的时候，基于Ribbon做负载均衡，从一个服务到多台机器中选择一台
* Feign：基于Feign的动态代理机制，根据注解和选择的机器，拼接请求的URL地址，发起请求
* Hystrix：发起请求是通过Hystrix的线程池来走的，不同的服务走不同的线程池，实现了不同服务调用的隔离，避免雪崩的问题
* Zuul：如果前端、移动端要调用后端系统，统一从Zuul网关进入，由Zuul请求给对应的服务

